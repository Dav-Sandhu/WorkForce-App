import{j as e,F as b,b as o,r as i,_ as d,u as f,a as v}from"./index.baaa2719.js";const w=({dispatch:a,reset_password:n})=>e(b,{children:n?o("div",{className:"card text-center reset-password",children:[e("button",{className:"close-button",onClick:()=>a({type:"reset_password",payload:""}),children:"X"}),e("div",{className:"card-header h5 text-white bg-primary",children:"Password Reset"}),o("div",{className:"card-body px-5",children:[e("p",{className:"card-text py-2",children:"Enter your email address and we'll send you an email with instructions to reset your password."}),o("div",{className:"form-outline",children:[e("input",{type:"email",id:"typeEmail",className:"form-control my-3"}),e("label",{className:"form-label",htmlFor:"typeEmail",children:"Email input"})]}),e("a",{href:"#",className:"btn btn-primary w-100",children:"Reset password"}),o("div",{className:"d-flex justify-content-between mt-4",children:[e("a",{className:"",href:"/login",children:"Login"}),e("a",{className:"",href:"/register",children:"Register"})]})]})]}):""}),g=(a,{type:n,payload:r})=>{switch(n){case"employee_number":return{...a,employee_number:r};case"password":return{...a,password:r};case"image":return{...a,image:r};case"alert":return{...a,alert:!a.alert};case"valid":return{...a,valid:Boolean(r)};case"empty_employee_number":return{...a,empty_employee_number:Boolean(r)};case"empty_password":return{...a,empty_password:Boolean(r)};case"checked":return{...a,checked:Boolean(r)};case"reset_password":return{...a,reset_password:!a.reset_password};default:return a}},N=i.exports.lazy(()=>d(()=>import("./FaceScanner.ce4878f6.js"),["assets/FaceScanner.ce4878f6.js","assets/index.baaa2719.js","assets/index.aed92d30.css","assets/FaceScanner.e9a6ad0c.css"])),R=()=>{const a=i.exports.useRef(null),n=i.exports.useRef(null),r=f(),u=sessionStorage.getItem("token"),c=v();if(u!==null)return(async()=>{const y=(await d(()=>import("./useDB.50c6ad0b.js"),[])).makeRequest;(await d(()=>import("./TokenLogin.fa8d08cf.js"),[])).default(u,y,c,r)})(),e("div",{class:"spinner-border",role:"status",children:e("span",{class:"visually-hidden",children:"Loading..."})});const[s,t]=i.exports.useReducer(g,{employee_number:"",password:localStorage.getItem("password")||"",image:null,alert:!1,valid:!0,empty_employee_number:!0,empty_password:!0,reset_password:!1}),h=l=>{t({type:l.target.id,payload:l.target.value})};return i.exports.useEffect(()=>{n.current.className.includes("is-invalid")||a.current.className.includes("is-invalid")?t({type:"valid",payload:!1}):t({type:"valid",payload:!0})},[s.employee_number,s.password]),o("div",{className:"login container",children:[e("h1",{className:"fw-bold fs-25 mb-1 text-center text-info title",children:"WorkForce Login"}),s.alert?o("div",{className:"alert alert-danger alert-dismissible",role:"alert",children:["Warning: Missing Fields",e("button",{className:"btn-close","aria-label":"close",onClick:()=>{t({type:"alert"})}})]}):"",o("form",{className:s.valid?"":"was-validated",noValidate:!0,onSubmit:l=>{l.preventDefault(),(async()=>{const m=(await d(()=>import("./useDB.50c6ad0b.js"),[])).makeRequest;try{const p=await m({type:"find-employee",values:[s.employee_number,s.password]},"/authenticate",null);sessionStorage.setItem("token",p.token),s.checked&&localStorage.setItem("password",s.password),(await d(()=>import("./TokenLogin.fa8d08cf.js"),[])).default(p.token,m,c,r)}catch{s.valid?alert("Login attempt failed, please make sure your information is correct!"):t({type:"alert"})}})()},children:[e("div",{className:"input-group mb-4",children:o("div",{className:"form-floating",children:[e("input",{id:"employee_number",className:s.empty_employee_number?"form-control":s.employee_number.length>0?"form-control is-valid":"form-control is-invalid",type:"text",ref:n,placeholder:"Employee Number",value:s.employee_number,onChange:l=>{h(l),t({type:"empty_employee_number",payload:!1})},required:!0}),e("label",{htmlFor:"employee_number",children:"Employee Number: "}),e("div",{className:"invalid-feedback user-invalid",children:"Invalid input"})]})}),o("div",{className:"form-floating mb-4",children:[e("input",{id:"password",className:s.empty_password?"form-control":s.password.length>0?"form-control is-valid":"form-control is-invalid",type:"password",ref:a,placeholder:"Password",value:s.password,onChange:l=>{h(l),t({type:"empty_password",payload:!1})},required:!0}),e("label",{htmlFor:"password",children:"Password: "}),e("div",{className:"invalid-feedback",children:"Invalid input"})]}),e("div",{className:"mb-4",children:o("div",{className:"form-check",children:[e("input",{className:"form-check-input",type:"checkbox",value:"",id:"savePassword",onChange:l=>{t({type:"checked",payload:l.target.checked})}}),e("label",{className:"form-check-label",htmlFor:"savePassword",children:"Remember Password"})]})}),e("input",{className:"btn btn-outline-primary",type:"submit",value:"Login"})]}),e("a",{className:"mb-4",onClick:()=>{t({type:"reset_password",payload:""})},children:"Forgot password?"}),o("p",{children:["Not a member? ",e("a",{href:"/register",children:"Register"})]}),e(N,{state:s,dispatch:t,navigate:c,user:r}),e(w,{dispatch:t,reset_password:s.reset_password})]})};export{R as default};
