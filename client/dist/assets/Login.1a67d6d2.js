import{r as n,j as e,F as g,a as o,_ as i,u as N,b as k}from"./index.392e2e1d.js";import R from"./Spinner.ec94a533.js";const E=({dispatch:s,reset_password:c})=>{const[t,d]=n.exports.useState("");return e(g,{children:c?o("div",{className:"card text-center reset-password",children:[e("button",{type:"button",className:"close-button btn-close",onClick:()=>s({type:"reset_password",payload:""})}),e("div",{className:"card-header h5 text-white bg-primary",children:"Lost Password"}),o("div",{className:"card-body px-5",children:[e("p",{className:"card-text py-2",children:"Enter your email address and we'll send you your password."}),o("div",{className:"form-outline",children:[e("input",{type:"email",id:"typeEmail",className:"form-control my-3",value:t,onChange:m=>d(m.target.value)}),e("label",{className:"form-label",htmlFor:"typeEmail",children:"Email input"})]}),e("a",{className:"btn btn-primary w-100",onClick:()=>{(async()=>{const u=(await i(()=>import("./useDB.d7bc65b2.js"),[])).makeRequest;i(()=>import("./Alert.0f69a7f2.js"),["assets/Alert.0f69a7f2.js","assets/index.392e2e1d.js","assets/index.c4470b89.css"]).then(async w=>{await w.customAlert("Notice","Your password will be sent to your email if it is in our system.","info")}),s({type:"reset_password",payload:""}),await u({sendInfo:"Reset",subject:"Password Reset",email:t,name:"Password Reset"},"/sendemail",null,"")})()},children:"Reset password"}),o("div",{className:"d-flex justify-content-between mt-4",children:[e("a",{className:"",href:"/login",children:"Login"}),e("a",{className:"",href:"/register",children:"Register"})]})]})]}):""})},x=(s,{type:c,payload:t})=>{switch(c){case"employee_number":return{...s,employee_number:t};case"email":return{...s,email:t};case"adp_number":return{...s,adp_number:t};case"password":return{...s,password:t};case"image":return{...s,image:t};case"alert":return{...s,alert:!s.alert};case"valid":return{...s,valid:Boolean(t)};case"empty_email":return{...s,empty_email:Boolean(t)};case"empty_password":return{...s,empty_password:Boolean(t)};case"checked":return{...s,checked:Boolean(t)};case"reset_password":return{...s,reset_password:!s.reset_password};default:return s}},L=n.exports.lazy(()=>i(()=>import("./FaceScanner.7d0f4304.js"),["assets/FaceScanner.7d0f4304.js","assets/index.392e2e1d.js","assets/index.c4470b89.css","assets/FaceScanner.04d20e16.css"])),F=()=>{const s=n.exports.useRef(null),c=n.exports.useRef(null),t=N(),d=k(),[m,f]=n.exports.useState(!1),[u,w]=n.exports.useState(!0);n.exports.useEffect(()=>{const r=sessionStorage.getItem("token");r!==null&&((async()=>{const v=await i(()=>import("./useDB.d7bc65b2.js"),[]);(await(await i(()=>import("./TokenLogin.5150e2e9.js"),[])).default(r,v.makeRequest,()=>d("/"),t)).status===-1&&(sessionStorage.removeItem("token"),window.location.reload())})(),f(!0))},[]);const[a,l]=n.exports.useReducer(x,{employee_number:"",adp_number:"",email:"",password:localStorage.getItem("password")||"",image:null,alert:!1,valid:!0,empty_email:!0,empty_password:!0,reset_password:!1}),y=r=>{l({type:r.target.id,payload:r.target.value})};return n.exports.useEffect(()=>{u||(c.current.className.includes("is-invalid")||s.current.className.includes("is-invalid")?l({type:"valid",payload:!1}):l({type:"valid",payload:!0}))},[a.employee_number,a.password]),e(g,{children:m?e(R,{}):u?o("div",{className:"face-recognition-section",children:[e(L,{state:a,dispatch:l,navigate:d,user:t}),e("button",{className:"btn btn-primary",type:"button",onClick:r=>{w(!1)},children:"Email Login"})]}):o("div",{className:"login container",children:[e("h1",{className:"fw-bold fs-25 mb-1 text-center text-info title",children:"WorkForce Login"}),a.alert?o("div",{className:"alert alert-danger alert-dismissible",role:"alert",children:["Warning: Missing Fields",e("button",{className:"btn-close","aria-label":"close",onClick:()=>{l({type:"alert"})}})]}):"",o("form",{className:a.valid?"":"was-validated",noValidate:!0,onSubmit:r=>{r.preventDefault(),(async()=>{const h=(await i(()=>import("./useDB.d7bc65b2.js"),[])).makeRequest,p=await h({email:a.email,password:a.password},"/login",null,"");if(console.log(a.email,a.password),console.log(p),p.status===1){const _=p.token;sessionStorage.setItem("token",_),a.checked&&localStorage.setItem("password",a.password),await(await i(()=>import("./TokenLogin.5150e2e9.js"),[])).default(_,h,()=>d("/"),t)}else a.valid?i(()=>import("./Alert.0f69a7f2.js"),["assets/Alert.0f69a7f2.js","assets/index.392e2e1d.js","assets/index.c4470b89.css"]).then(async _=>{await _.customAlert("Login attempt failed!","Please make sure your information is correct.","error")}):l({type:"alert"})})()},children:[e("div",{className:"input-group mb-4",children:o("div",{className:"form-floating",children:[e("input",{id:"email",className:a.empty_email?"form-control":a.email.length>0?"form-control is-valid":"form-control is-invalid",type:"text",ref:c,placeholder:"Email",value:a.email,onChange:r=>{y(r),l({type:"empty_email",payload:!1})},required:!0}),e("label",{htmlFor:"employee_number",children:"Email: "}),e("div",{className:"invalid-feedback user-invalid",children:"Invalid input"})]})}),o("div",{className:"form-floating mb-4",children:[e("input",{id:"password",className:a.empty_password?"form-control":a.password.length>0?"form-control is-valid":"form-control is-invalid",type:"password",ref:s,placeholder:"Password",value:a.password,onChange:r=>{y(r),l({type:"empty_password",payload:!1})},required:!0}),e("label",{htmlFor:"password",children:"Password: "}),e("div",{className:"invalid-feedback",children:"Invalid input"})]}),e("div",{className:"mb-4",children:o("div",{className:"form-check",children:[e("input",{className:"form-check-input",type:"checkbox",value:"",id:"savePassword",onChange:r=>{l({type:"checked",payload:r.target.checked})}}),e("label",{className:"form-check-label",htmlFor:"savePassword",children:"Remember Password"})]})}),e("input",{className:"btn btn-outline-primary",type:"submit",value:"Login"})]}),e("a",{className:"mb-4 password-reset",onClick:()=>{l({type:"reset_password",payload:""})},children:"Forgot password?"}),o("p",{children:["Not a member? ",e("a",{href:"/register",children:"Register"})]}),e(E,{dispatch:l,reset_password:a.reset_password})]})})};export{F as default};
