import{r,_ as m,b as p,F as v,j as t}from"./index.fec864ca.js";const I=r.exports.lazy(()=>m(()=>import("./react-webcam.e4161001.js").then(s=>s.r),["assets/react-webcam.e4161001.js","assets/index.fec864ca.js","assets/index.aed92d30.css"])),F=({state:s,dispatch:g,navigate:_,user:h})=>{const[f,b]=r.exports.useState(!1),[w,S]=r.exports.useState(!1),u=r.exports.useRef(null),y=()=>{const n=u.current.getScreenshot();n?(g({type:"image",payload:n}),(async()=>{const d=await m(()=>import("./FaceRecognition.17873a21.js"),[]),x=await m(()=>import("./useDB.50c6ad0b.js"),[]);await d.loadModels();const c=x.makeRequest,o=await c(null,"/pictures",null);let i=!1,l=0;for(let a=0;a<o.length;a++){let e=await d.compareFaces(n,o[a].picture);i=e?!0:i,l=e?a:l}if(i){const a=await c({picture:o[l].picture},"/facematch",null),e=await c(null,"/userInfo",a);e.length>0?(sessionStorage.setItem("token",a.token),h.setUserInfo({employee_number:e[0].employee_number,first_name:e[0].first_name,last_name:e[0].last_name,email:e[0].email,password:e[0].password,hourly_wage:e[0].hourly_wage,picture:e[0].picture}),_("/")):alert("Something went wrong...")}else alert("face not recognized!")})()):alert("Failed to capture picture, try again!")};return p(v,{children:[t("hr",{className:"mt-2 mb-3"}),f?t("div",{className:"image-area",children:s.image===null?p("div",{className:"camera mb-5",onClick:y,children:[t(I,{ref:u,screenshotFormat:"image/jpeg",onUserMedia:()=>{S(!0)},height:"100%",width:"100%",videoConstraints:{facingMode:"user"}}),w?t("div",{className:"scan-text",children:"Scan"}):""]}):t("img",{className:"user-picture mb-5",src:s.image})}):t("div",{className:"d-grid gap-2",children:t("button",{className:"btn btn-danger",type:"button",onClick:n=>{b(!0)},children:"Or Scan your face to login!"})})]})};export{F as default};
