import{r as s,_ as o,b as d,F as x,j as e}from"./index.d2935ba6.js";const E=s.exports.lazy(()=>o(()=>import("./react-webcam.6741e110.js").then(t=>t.r),["assets/react-webcam.6741e110.js","assets/index.d2935ba6.js","assets/index.aed92d30.css"])),F=({state:t,dispatch:p,navigate:_,user:h})=>{const[f,b]=s.exports.useState(!1),[w,v]=s.exports.useState(!1),u=s.exports.useRef(null),S=()=>{const n=u.current.getScreenshot();n?(p({type:"image",payload:n}),(async()=>{const g=await o(()=>import("./FaceRecognition.17873a21.js"),[]),k=await o(()=>import("./useDB.50c6ad0b.js"),[]);await g.loadModels();const r=k.makeRequest,i=await r(null,"/pictures",null);let l=!1,m=0;for(let a=0;a<i.length;a++)try{let c=await g.compareFaces(n,i[a].picture);l=c?!0:l,m=c?a:m}catch{}if(l){const a=await r({picture:i[m].picture},"/facematch",null);sessionStorage.setItem("token",a.token),(await o(()=>import("./TokenLogin.fa8d08cf.js"),[])).default(a.token,r,_,h)}else alert("face not recognized!"),window.location.reload()})()):(alert("Failed to capture picture, try again!"),window.location.reload())};return d(x,{children:[e("hr",{className:"mt-2 mb-3"}),f?e("div",{className:"image-area",children:t.image===null?d("div",{className:"camera mb-5",onClick:S,children:[e(E,{ref:u,screenshotFormat:"image/jpeg",onUserMedia:()=>{v(!0)},height:"100%",width:"100%",videoConstraints:{facingMode:"user"}}),w?e("div",{className:"scan-text",children:"Scan"}):""]}):d("div",{children:[e("h2",{children:"Loading..."}),e("img",{src:t.image,className:"img-fluid user-picture mb-5"})]})}):e("div",{className:"d-grid gap-2",children:e("button",{className:"btn btn-danger",type:"button",onClick:n=>{b(!0)},children:"Or Scan your face to login!"})})]})};export{F as default};
