import{r,_ as i,b as u,F as k,j as t}from"./index.3e918ae7.js";const E=r.exports.lazy(()=>i(()=>import("./react-webcam.11790393.js").then(n=>n.r),["assets/react-webcam.11790393.js","assets/index.3e918ae7.js","assets/index.aed92d30.css"])),N=({state:n,dispatch:_,navigate:h,user:f})=>{const[b,w]=r.exports.useState(!1),[v,S]=r.exports.useState(!1),g=r.exports.useRef(null),x=()=>{const c=g.current.getScreenshot();c?(_({type:"image",payload:c}),(async()=>{const p=await i(()=>import("./FaceRecognition.f067681b.js"),[]),l=(await i(()=>import("./useDB.4a39d696.js"),[])).makeRequest;await p.loadModels();const m=(await l(null,"/pictures",null)).output;let s=!1,d=0,o=1;for(let a=0;a<m.length;a++)try{let e=await p.compareFaces(c,m[a].picture);s=e<.6?!0:s,d=e<o?a:d,o=e<o?e:o}catch{}if(s){const a=await l({picture:m[d].picture},"/facematch",null);if(a.status===1){const e=a.token;sessionStorage.setItem("token",e),(await i(()=>import("./TokenLogin.fa3ff8bd.js"),[])).default(e,l,()=>h("/"),f)}else s=!1}s||(alert("face not recognized!"),window.location.reload())})()):(alert("Failed to capture picture, try again!"),window.location.reload())};return u(k,{children:[t("hr",{className:"mt-2 mb-3"}),b?t("div",{className:"image-area",children:n.image===null?u("div",{className:"camera mb-5",onClick:x,children:[t(E,{ref:g,screenshotFormat:"image/jpeg",onUserMedia:()=>{S(!0)},height:"100%",width:"100%",videoConstraints:{facingMode:"user"}}),v?t("div",{className:"scan-text",children:"Scan"}):""]}):u("div",{children:[t("h2",{children:"Loading..."}),t("img",{src:n.image,className:"img-fluid user-picture mb-5"})]})}):t("div",{className:"d-grid gap-2",children:t("button",{className:"btn btn-danger",type:"button",onClick:c=>{w(!0)},children:"Or Scan your face to login!"})})]})};export{N as default};
